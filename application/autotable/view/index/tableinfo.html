<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<META content="MSHTML 6.00.2900.5921" name=GENERATOR></HEAD>
	<link rel="stylesheet" type="text/css" href="__PUBLIC__autotable/css/style_btn.css">
	<link rel="stylesheet" type="text/css" href="__PUBLIC__autotable/css/style.css">	
	<title></title>
	<script type="text/javascript" src="__PUBLIC__autotable/js/jquery-1.11.0.min.js"></script>

	<link rel="stylesheet" type="text/css" href="__PUBLIC__autotable/js/weboffice/style.css">
	<script type="text/javascript" src="__PUBLIC__autotable/js/weboffice/main.js"></script>
	<SCRIPT language=javascript event=NotifyCtrlReady for=WebOffice1>

	/****************************************************
	*
	*	在装载完Weboffice(执行<object>...</object>)
	*	控件后执行 "WebOffice1_NotifyCtrlReady"方法
	*
	****************************************************/
		WebOffice1_NotifyCtrlReady()
	</SCRIPT>

	<SCRIPT language=javascript event=NotifyWordEvent(eventname) for=WebOffice1>
	<!--
	 WebOffice1_NotifyWordEvent(eventname);
	 
	//-->
	</SCRIPT>

	<SCRIPT language=javascript event=NotifyToolBarClick(iIndex) for=WebOffice1>
	<!--
	 WebOffice1_NotifyToolBarClick(iIndex);
	//-->
	</SCRIPT>

	<SCRIPT language=javascript>
	/****************************************************
	*
	*		控件初始化WebOffice方法
	*
	****************************************************/
	function WebOffice1_NotifyCtrlReady() {

		document.all.WebOffice1.OptionFlag |= 128;
		// 新建文档
		//document.all.WebOffice1.LoadOriginalFile("", "doc");
		spnWebOfficeInfo.innerText="----   您电脑上安装的WebOffice版本为:V" + document.all.WebOffice1.GetOcxVersion() +"\t\t\t本实例是根据版本V6044编写";
		document.all.WebOffice1.LoadOriginalFile("http://192.168.0.112:8076/shuangliu/Temp/192.168.0.78/收讫通知.xls", "xls");
	}
	var flag=false;
	function menuOnClick(id){
		var id=document.getElementById(id);
		var dis=id.style.display;
		if(dis!="none"){
			id.style.display="none";
			
		}else{
			id.style.display="block";
		}
	}
	/****************************************************
	*
	*		接收office事件处理方法
	*
	****************************************************/
	var vNoCopy = 0;
	var vNoPrint = 0;
	var vNoSave = 0;
	var vClose=0;
	function no_copy(){
		vNoCopy = 1;
	}
	function yes_copy(){
		vNoCopy = 0;
	}


	function no_print(){
		vNoPrint = 1;
	}
	function yes_print(){
		vNoPrint = 0;
	}


	function no_save(){
		vNoSave = 1;
	}
	function yes_save(){
		vNoSave = 0;
	}
	function EnableClose(flag){
	 vClose=flag;
	}
	function CloseWord(){
		
	  document.all.WebOffice1.CloseDoc(0); 
	}

	function WebOffice1_NotifyWordEvent(eventname) {
		if(eventname=="DocumentBeforeSave"){
			if(vNoSave){
				document.all.WebOffice1.lContinue = 0;
				alert("此文档已经禁止保存");
			}else{
				document.all.WebOffice1.lContinue = 1;
			}
		}else if(eventname=="DocumentBeforePrint"){
			if(vNoPrint){
				document.all.WebOffice1.lContinue = 0;
				alert("此文档已经禁止打印");
			}else{
				document.all.WebOffice1.lContinue = 1;
			}
		}else if(eventname=="WindowSelectionChange"){
			if(vNoCopy){
				document.all.WebOffice1.lContinue = 0;
				//alert("此文档已经禁止复制");
			}else{
				document.all.WebOffice1.lContinue = 1;
			}
		}else   if(eventname =="DocumentBeforeClose"){
		    if(vClose==0){
		    	document.all.WebOffice1.lContinue=0;
		    } else{
		    	//alert("word");
			    document.all.WebOffice1.lContinue = 1;
			  }
	 }
		//alert(eventname); 
	}
	function dd(){

		document.all.WebOffice1.FullScreen=0;

	}
	//隐藏工具栏
</SCRIPT>
</head>

<body style="background: #fff;overflow: hidden;" onunload="return window_onunload()">
	<div class="form-menu">
		<a href="javascript:;" class="bc" onclick="return UpFile()"></a>
		<a href="javascript:;" class="off"></a>
		<a href="javascript:zhiPrint();" class="dy"></a>
		<a href="javascript:;" class="white"></a>
		<a href="javascript:IdCard();" class="idcord"></a>
	</div>
	<div class="add-excel">
      <SCRIPT src="__PUBLIC__autotable/js/weboffice/LoadWebOffice.js"></SCRIPT>
	</div>
	<SCRIPT language=javascript event=NotifyCtrlReady for=WebOffice1>
		document.all.WebOffice1.OptionFlag |= 128;
		
		//隐藏工具条
		var webObj=document.getElementById("WebOffice1");
		webObj.ShowToolBar =  !webObj.ShowToolBar;		
		document.all.WebOffice1.LoadOriginalFile("{$resturl}", 'xlsx');
		hideAll('hideall','','','');//07
		hideAll('','','','');//03
			
		
	</SCRIPT>
	<script type="text/javascript">
		function UpFile(){
			var returnValue; // 保存页面的返回值
			document.all.WebOffice1.HttpInit(); // 初始化Http 引擎
			// 添加上传文件
			document.all.WebOffice1.HttpAddPostCurrFile("ExcelFile","");
			// 提交上传文件
			returnValue = document.all.WebOffice1.HttpPost("http://192.168.0.10:8076/sbxt/index.php/autotable/index/upexcel?tempid={$tempid}");
			alert(returnValue); 
			CloseWindow();
		}
		function CloseWindow(){
			CloseWord();
			window_onunload();
			window.opener = null; 
			window.open("","_self");
			window.close();
		}
		function CloseWord(){				
			document.all.WebOffice1.CloseDoc(0); 
		}
		// 扫描身份证
		function IdCard(){			
			var returnValue; // 保存页面的返回值
			document.all.WebOffice1.HttpInit(); // 初始化Http 引擎
			// 添加上传文件
			document.all.WebOffice1.HttpAddPostCurrFile("ExcelFile","");
			// 提交上传文件
			returnValue = document.all.WebOffice1.HttpPost("http://192.168.0.10:8076/sbxt/index.php/autotable/index/save_excel?tempid={$tempid}");
			// alert(returnValue); 
			// return false;
			if(returnValue == 1){
				window.location.href="idcard.php?tempid={$tempid}&tableid={$id}";
			}else {
				alert("失败稍后再试");
			} 
			CloseWindow();
		}
	</script>
</body>
</html>